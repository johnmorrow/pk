<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>pk by johnmorrow</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>pk</h1>
        <p>A field extractor command line utility</p>
        <p class="view"><a href="https://github.com/johnmorrow/pk">View the Project on GitHub <small>johnmorrow/pk</small></a></p>
        <ul>
          <li><a href="https://github.com/johnmorrow/pk/releases/download/v1.0.2/pk-1.0.2.tar.gz">Download <strong>v1.0.2 tgz</strong></a></li>
          <li><a href="https://github.com/johnmorrow/pk">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p>Do you use lots of shell pipelines and find yourself choosing between <em>cut</em>
and <em>awk</em> to select columns from input? <em>pk</em> is designed as a middle-ground
tool; flexible enough to handle variable numbers of delimiters, fixed format
files, quoted or escaped delimiters and more.</p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<pre lang="shell"><code>Usage: pk [OPTION...] [STRING...]
A field extraction utility

  -b, --backslash            Backslash escapes delimiters
  -d, --delimiters=STRING    Characters used as input delimiters
  -e, --empty                Allow empty fields
  -E, --excludes[=STRINGS]   Strings excluded from output (separated by :)
  -f, --file=FILE            Read input from file instead of stdin
  -N, --null[=STRING]        Change output text used for empty fields
  -q, --quotes[=STRING]      Ignore delimiters within quotes
  -S, --separator=STRING     Separator used in output text
  -T, --trim                 Trim non-alphanumerics characters before printing
  -?, --help                 Give this help list
      --usage                Give a short usage message
  -V, --version              Print program version
</code></pre>

<p>It may help to remember that when using short flags, lower-case flags
will affect how the input is processed, for example, changing the field
delimiters. Upper-case flags will affect the output of pk, for example,
the output separator or whether tokens are trimmed of alphanumerics.</p>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<h4>
<a name="basic-usage" class="anchor" href="#basic-usage"><span class="octicon octicon-link"></span></a>Basic usage</h4>

<p><em>pk</em> is a tool for grabbing columns from an input stream
and printing them on <em>stdout</em>. Each argument represents something
you would like to see appearing in the output.</p>

<p>If an argument string is a positive integer then it is a request
to see that column from the input printed in the output. The first
column in the input stream has an index of 1.</p>

<pre lang="shell"><code>$ df | pk 6 5
Mounted Use%
/ 9%
/dev 1%
/run 1%
/run/lock 0%
/run/shm 0%
</code></pre>

<p>An argument string can also represent a range of fields.
The following range formats are supported:</p>

<table>
<thead><tr>
<th>Format</th>
<th>Meaning</th>
</tr></thead>
<tbody>
<tr>
<td>X..Y</td>
<td>Print each field from index X through to index Y</td>
</tr>
<tr>
<td>X..</td>
<td>Print each field from index X through to the last field</td>
</tr>
<tr>
<td>..Y</td>
<td>Print each field from field 1 through to field Y</td>
</tr>
<tr>
<td>..</td>
<td>Print every field</td>
</tr>
</tbody>
</table><p>Here are examples of each type of range:</p>

<pre lang="shell"><code>$ echo A B C D E | pk 2..4
B C D
$ echo A B C D E | pk 2..
B C D E
$ echo A B C D E | pk ..3
A B C
$ echo A B C D E | pk ..
A B C D E
</code></pre>

<p>Finally, any argument that does not appear to be an index or
a range is outputted directly. This can be useful for putting
together command lines or quick scripts:</p>

<pre lang="shell"><code>$ ls -l /etc | pk 9 is owned by 3
adduser.conf is owned by root
alternatives/ is owned by root
apparmor/ is owned by root
</code></pre>

<h4>
<a name="changing-the-delimiters" class="anchor" href="#changing-the-delimiters"><span class="octicon octicon-link"></span></a>Changing the delimiters</h4>

<p>In its default mode of operation <em>pk</em> uses both <code>&lt;tab&gt;</code> and
<code>&lt;space&gt;</code> as delimiter characters. Additionally, multiple delimiters
appearing next to each other in the input stream are treated as
a single delimiter. This makes it good for parsing input streams
where the columns are separated by varying amounts of whitespace.
Many system tools such as <em>ps</em>, <em>df</em>, <em>last</em>, etc. use this kind
of output.</p>

<p>By using the <strong>-d</strong> flag you can change the set of delimiters. Note
that the string argument to <strong>-d</strong> contains a set of characters, each
of which is a delimiter. This is a not a fixed string that separates
each field.</p>

<h4>
<a name="the-output-separator" class="anchor" href="#the-output-separator"><span class="octicon octicon-link"></span></a>The output separator</h4>

<p>By default the field specified for printed will be outputed separated
by single spaces. Use the <strong>-S</strong> flag to change the string that separates
output fields:</p>

<pre lang="shell"><code>$ ps aux | pk -S, 1 2 | head
USER,PID
root,1
root,2
root,3
</code></pre>

<h4>
<a name="fixed-format-files" class="anchor" href="#fixed-format-files"><span class="octicon octicon-link"></span></a>Fixed format files</h4>

<p>Fixed formats, such as <em>/etc/passwd</em>, can have different delimiters and
possibly contain empty fields. Using the <strong>-e</strong> flag tells <em>pk</em> that
adjacent delimiter characters in the input line represent empty fields.</p>

<pre lang="shell"><code>$ cat /etc/passwd | pk -e -d: 1 7
root /bin/bash
daemon /bin/sh
bin /bin/sh
sys /bin/sh
</code></pre>

<h4>
<a name="empty-fields" class="anchor" href="#empty-fields"><span class="octicon octicon-link"></span></a>Empty fields</h4>

<p>If you tell <em>pk</em> to print an empty field it will print out the string
<em>NULL</em> by default. This can be set to another string using the <strong>-N</strong> flag.
If this flag is used without an argument then empty fields are not printed.</p>

<p>Note that <em>pk</em> will not print trailing empty fields unless you specify
them directly using their index. i.e. trailing empty fields are not printed
if specified as a range.</p>

<h4>
<a name="trimming-non-alphanumeric-fields" class="anchor" href="#trimming-non-alphanumeric-fields"><span class="octicon octicon-link"></span></a>Trimming non-alphanumeric fields</h4>

<p>The <strong>-T</strong> flags trims non-alphanumeric characters from the left and right side
before printing the field to stdout. This is useful removing quotes,
parentheses or other visual delineations.</p>

<pre lang="shell"><code>$ echo "'Example User' &lt;foobar@example.com&gt;" | pk -T 3
foobar@example.com
</code></pre>

<h4>
<a name="quoting" class="anchor" href="#quoting"><span class="octicon octicon-link"></span></a>Quoting</h4>

<p>Some text formats allow delimiters to be ignored inside quotes.
<em>pk</em> supports simple quoting, that is you can select a single
quote character or a pair (start and end) of characters. Nested
quotes or multiple types of quoting on the same line are not
supported.</p>

<p>Use the <strong>-q</strong> flag to enable quoting support. Double quote is the
default quote character:</p>

<pre lang="shell"><code>$ cat input
"Bilbo Baggins", "The Hobbit"
"Frodo Baggins", "The Lord of the Rings"
$ pk -f input -d", " -q 2
"The Hobbit"
"The Lord of the Rings"
</code></pre>

<p>The quote character can be changed by supplying a one character
argument to the <strong>-q</strong> flag:</p>

<pre lang="shell"><code>$ cat input
'Bilbo Baggins', 'The Hobbit'
'Frodo Baggins', 'The Lord of the Rings'
$ pk -f input -d", " -q"'" 1
'Bilbo Baggins'
'Frodo Baggins'
</code></pre>

<p>A two character argument supplied to the <strong>-q</strong> flag is used to
specify the open and close quote characters:</p>

<pre lang="shell"><code>$ cat input
(Bilbo Baggins) (The Hobbit)
(Frodo Baggins) (The Lord of the Rings)
$ pk -f input -q"()" 1
(Bilbo Baggins)
(Frodo Baggins)
$ pk -f input -q"()" -T 1
Bilbo Baggins
Frodo Baggins
</code></pre>

<h4>
<a name="excludes" class="anchor" href="#excludes"><span class="octicon octicon-link"></span></a>Excludes</h4>

<p>A list of strings that will always be excluded from the output can be supplied
to pk via the <strong>-E</strong> flag. An example use case for this is when dealing with
lists of servers you may want to automatically strip fully qualified hostnames
down to their local names before passing on to another process in the pipeline.</p>

<pre lang="shell"><code>$ cat input
foo.example.com 192.168.1.1 active
bar.example.com 192.168.1.2 repair
baz.example.net 192.168.1.3 active
$ cat input | pk -E.example.com:.example.net 1 3
foo active
bar repair
baz active
</code></pre>

<p>Alternatively, as this is likely to be a regular request, it can be set using an
environment variable. When using the environment variable the <strong>-E</strong> flag without
arguments can be used to ignore the setting. The <strong>-E</strong> flag used with arguments
will override the environment variable.</p>

<pre lang="shell"><code>$ export PK_EXCLUDES=.example.com:.example.net
$ cat input | pk 1 3
foo active
bar repair
baz active
$ cat input | pk -E 1 3
foo.example.com active
bar.example.com repair
baz.example.net active
</code></pre>

<h2>
<a name="licensing" class="anchor" href="#licensing"><span class="octicon octicon-link"></span></a>Licensing</h2>

<p>Copyright 2012-Present John Morrow</p>

<p>I am providing code in this repository to you under an open source license.
Because this is my personal repository, the license you receive to my code
is from me and not my employer (Facebook).</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/johnmorrow">johnmorrow</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
